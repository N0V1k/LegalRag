# Проект по курсу NLP-course. Spring 2025 от ODS.ai: RAG система для юридических текстов

## Введение
Область юриспруденции является одной из тех профессиональных сфер, где внедрение информационных систем на базе языкового моделирования может принести значительную пользу, как профессиональным юристам, так и обычным людям. Чтение юридических документов требует высокой квалификации читающего. Они содержат большое количество профильной терминологии и, зачастую, содержат десятки, а то и сотни страниц, на обработку которых требуется много времени, а соответственно материальных затрат. Ещё одна сложность заключается в постоянно меняющейся правовой базе: только за 2024 год государственная дума РФ приняла 564 новых федеральных закона, а в налоговом кодексе изменения появляются в среднем каждые две недели.
На данный момент, лучшим из возможных способов обработки и генерации является технология большой языковой модели (LLM). Однако, все большие языковые модели обучаются на общих корпусах разнородных текстов из мировой сети и, зачастую, плохо справляются со специфическими задачами в силу редкой терминологии, сложности правовых конструкций и требований к точности формулировок. Также, они редко обновляют базу своих знаний, что критично, учитывая вышеуказанную переменчивость законодательной базы.
Но, всё-таки, хотелось бы иметь виртуального помощника, способного дёшево, быстро и, самое главное, качественно отвечать на вопросы о законодательстве и давать советы в юридических спорах. Поэтому возникает задача адаптировать существующую языковую модель для устранения описанных выше проблем.

## Цель 
Объектом данного исследования является технология LLM-моделирования.
Предметом изучения выступают методы адаптации больших языковых моделей к решению задач узкого профиля.
Целью исследования является сравнения двух методов адаптации больших языковых моделей: частный случай параметрически-эффективного тонкого дообучения в виде низко-ранговой адаптации(Low-Rank Adaptation) и генерацию на основе расширенного извлечения контекста (Retrieval-Augmented Generation) и создание агента.

## Задачи
Для достижения поставленной цели предполагается решить следующие задачи:
1)  из открытых источников собрать и обработать данные для
дообучения модели, а также для создания векторной базы
нормативно-правовых актов РФ
2)  провести дообучение модели, а также реализовать RAG-систему
3)  сравнить полученные модели на тестовом наборе данных для
оценки качества решения задачи генерации ответов на юридические
вопросы.

*Для обучения использовалась модель Meta-Llama-3.1-8B*

## Описание файлов репозитория:

codex_parser.ipynb - парсер кодексов и ФЗ
codex_structure.ipynb - файл с выводом структуры кодексов
create_agent.ipynb - файл с созданием агента, использующим RAG и дообученную модель (подсчёт бертскора)
create_retriever.ipynb - файл с созданием и сравнением разных ретриверов
create_vector_store.ipynb - файл создания векторной БД
deepseek_g_eval - файл с реализацией LLM as Judge для оценки ответов LLM
deepseek_create_dataset.ipynb  - файл создания датасета для обучения и валидации модели
QLora_train_v1.ipynb - файл с обучением модели (версия 1)
QLora_train_v2.ipynb - файл с обучением модели (версия 2)


